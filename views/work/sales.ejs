<%- include('../includes/first-part.ejs') %>
    <link rel="stylesheet" href="/css/table.css" />
  </head>
  <body>
    <%- include('../includes/header.ejs') %>

    <div class="container">
      <%- include('../includes/nav.ejs') %>
      <main>
        <h3> ➣&nbsp&nbsp<%= menuTitle %></h3>
        <hr />
        <form action="/sales" method="GET">
          <div class="v-part sort-part">
            <table id="condition-table">
              <tr>
                <th class="h-header">팀선택</th>
                <th class="h-header">시작월</th>
                <th class="h-header">종료월</th>
                <th class="h-header">대행사</th>
                <th class="h-header">광고주</th>
                <input type="submit" id="submit-button" hidden>
                <th class="h-header" rowspan="2"><p class="excel-download" id="excel-download">엑셀다운로드</p></th>
              </tr>
              <tr>
                <td>
                  <select name="team" id="">
                    <option value="" <%= sortInfo.team === "" ? "selected" : "" %>>전체보기</option>
                    <% teams.forEach(team => { %>
                      <option value="<%= team.id %>" <%= sortInfo.team == team.id ? "selected" : "" %>><%= team.name %> 팀</option>  
                    <% }) %>
                  </select>
                </td>
                <td>
                  <input type="month" name="start_month" value="<%= sortInfo.start_month %>">
                </td>
                <td>
                  <input type="month" name="end_month" value="<%= sortInfo.end_month %>">
                </td>
                <td>
                  <select name="agency" id="">
                    <option value="" <%= sortInfo.agency === "" ? "selected" : "" %>>전체보기</option>
                    <% agencies.forEach(agency => { %>
                      <option value="<%= agency.id %>" <%= sortInfo.agency == agency.id ? "selected" : "" %>><%= agency.name %></option>  
                    <% }) %>
                  </select>
                </td>
                <td>
                  <select name="advertiser" id="">
                    <option value="" <%= sortInfo.advertiser === "" ? "selected" : "" %>>전체보기</option>
                    <% advertisers.forEach(advertiser => { %>
                      <option value="<%= advertiser.id %>" <%= sortInfo.advertiser == advertiser.id ? "selected" : "" %>><%= advertiser.name %></option>  
                    <% }) %>
                  </select>
                </td>
              </tr>
            </table>
          </div>

          <div class="v-part result-part">
            <table id="result-table">
              <tr>
                <th class="v-header" rowspan="2" style="width: 50px;">담당팀</th>
                <th class="v-header" rowspan="2" style="width: 60px;">연도</th>
                <th class="v-header" rowspan="2" style="width: 50px;">월</th>
                <th class="v-header" rowspan="2" style="width: 180px;">광고주</th>
                <th class="v-header" rowspan="2" style="width: 250px;">캠페인명</th>
                <th class="v-header" rowspan="2" style="width: 180px;">대행사</th>
                <th class="v-header" rowspan="2" style="width: 110px;">광고수주액</th>
                <th class="v-header" colspan="4">수익배분액</th>
              </tr>
              <tr>
                <th class="v-header" style="width: 110px;">대행사 수수료</th>
                <th class="v-header" style="width: 110px;">매체 수수료</th>
                <th class="v-header" style="width: 110px;">순매출</th>
                <th class="v-header" style="width: 110px;">인터렙 수수료</th>
              </tr>
              <tr>
                <th class="v-total">Total</th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
                <th class="v-total"></th>
              </tr>
              <% campaigns.forEach(campaign => { %>
                <tr>
                  <th><%= teams.find(team => team.id === campaign.teamId).name %> 팀</th>
                  <th><%= campaign.tax_date.getFullYear() %> 년</th>
                  <th><%= campaign.tax_date.getMonth()+1 %> 월</th>
                  <th><%= advertisers.find(advertiser => advertiser.id === campaign.advertiserId).name %></th>
                  <th><%= campaign.title %></th>
                  <th><%= agencies.find(agency => agency.id === campaign.agencyId).name %></th>
                  <th><%= campaign.ad_fee %></th>
                  <th><%= campaign.agency_fee %></th>
                  <th><%= campaign.media_fee %></th>
                  <th><%= campaign.dplan_fee %></th>
                  <th><%= campaign.inter_fee %></th>
                </tr>
              <% }) %>
            </table>
          </div>
        </form>
      </main>
    </div>

    <script src="/js/work/sale.js"></script>
  <%- include('../includes/end-part.ejs') %>
